
// ------------------------------------------------------------------------
var formUpText = document.getElementsByClassName("footer-upperline"),
  name,
  email,
  text;
var buttonState = 1; // Variable to track button state

// function showAlert() {
//   myform.reset(),
//     (document.getElementById("alertBox").style.display = "block"),
//     (myform.style.display = "none"),
//     (formUpText[0].style.display = "none");
// }
function closeAlert() {
  (document.getElementById("alertBox").style.display = "none"),
    (myform.style.display = "block"),
    (formUpText[0].style.display = "block");
}
var myform = document.getElementById("my_form");
function validateEmail(email) {
  var re;
  return /\S+@\S+\.\S+/.test(email);
}
function InvalidMsg(textbox) {
  return (
    "" === textbox.value
      ? textbox.setCustomValidity("Entering an email-id is necessary!")
      : textbox.validity.typeMismatch
      ? textbox.setCustomValidity(
          "Please enter an email address which is valid!"
        )
      : textbox.setCustomValidity(""),
    !0
  );
}
function SpillInvalidMsg(textbox) {
  if (textbox.value.length > 250) {
    textbox.setCustomValidity("Response must be under 250 characters.");
  } else {
    textbox.setCustomValidity("");
  }
  // Trigger form validation check
  textbox.reportValidity();
  return true;
}

// Add the event listener to your input element
if (document.querySelector("#textuser")) {
  document.getElementById("textuser").addEventListener("textbox", function () {
    SpillInvalidMsg(this);
  });
}
function handleSubmit(event) {
  event.preventDefault();
  if (buttonState === 1) {
    buttonState = 0; // Set to 0 to disable the button
    document.getElementById("btnSubmit").disabled = true;
  }
}

var v = 1;

if (myform) {
  myform.addEventListener("submit", function (e) {
    e.preventDefault();    
    // Track lead event for Facebook Pixel
    fbq('track', 'Lead', {
        name: document.getElementById('nameuser').value,
        email: document.getElementById('gmaiiluser').value,
        message: document.getElementById('textuser').value
    });

    // You can process form data submission here (e.g., send it to your server)
    
    console.log("Form submitted");

    // Optionally, reset the form
    document.getElementById('my_form').reset();



    const nameUser = myform.elements.item(0).value;
    const emailUser = myform.elements.item(1).value;
    const textUser = myform.elements.item(2).value;

         const bodytxt =
        "Name: " +
        `<b>${nameUser}</b>` +
        "<br>\n Email: " +
        `<b>${emailUser}</b>` +
        "\n Message: <br>" +
        `<b>${textUser}</b>`;

      Email.send({
        Host: "smtp.elasticemail.com",
        Username: "iminfo@integramagna.com",
        Password: "F63AAC721194CFB801A7F3163DBC96920A2B",
        To: "hi@integramagna.com",
        From: "hi@integramagna.com",
        Subject: "Enquiry - Integra Magna",
        Port: 2525,
        Body: bodytxt,
      }).then((message) => showAlert());
    
  });
}

function validateEmail(email) {
  var re = /\S+@\S+\.\S+/;
  return re.test(email);
}

function showAlert() {
  event.preventDefault();
  document.getElementById("footer-form-pop").style.display = "flex";
  document.getElementById("popform-container").style.display = "flex";
  //lock scroll
  document.body.classList.add("no-scroll");
  document.getElementById("footer-form-pop").classList.add("no-scroll");
  //clear my form after this
  // console.log(myform);
  myform.reset();
  buttonState = 1; // Set to 1 to enable the button
  if (buttonState === 1) {
    document.getElementById("btnSubmit").disabled = false;
  }
  // alert("Your message has been sent successfully!");
}
